<!-- Loading State -->
<div *ngIf="isLoading" class="flex justify-center items-center h-64">
  <div class="text-center">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-[#16968c] mx-auto"></div>
    <p class="mt-4 text-gray-600">جاري تحميل البيانات...</p>
  </div>
</div>

<!-- Main Content -->
<div *ngIf="!isLoading">
  <!-- ============================= -->
  <!-- BREAD CRUMB -->
  <!-- ============================= -->
  <div class="bg-white px-5 pt-3 rounded">
    <app-bread-crumb [title]="'إدارة الأصول'" [imageTitle]="'./assets/icons/projectsActive.svg'" [subTitles]="[
        { name: 'الرئيسية', routerLink: '' },
        { name: 'إدارة الأصول', routerLink: '/buildings/assets' },
        {
          name: 'عرض سجل الصيانة للأصل',
          routerLink: '/buildings/assets/maintenance-log-for-asset'
        }
      ]">
    </app-bread-crumb>

    <!-- Request Information -->
    <div class="mt-7 mb-5">
      <h1 class="font-bold mb-3">معلومات الطلب</h1>
      <hr />
      <div class="py-5">
        <p class="text-[#16968c] mb-5">
          رقم طلب الصيانة: <span class="text-[#000]">{{ maintenanceRequestNumber }}</span>
        </p>
        <p class="text-[#16968c]">
          تاريخ المعالجة: <span class="text-[#000]">{{ processingDate }}</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Responsible Party Information -->
  <div class="bg-white px-5 pt-3 pb-5 rounded mt-5">
    <h1 class="font-bold mb-3">بيانات الجهة المسؤولة</h1>
    <hr />
    <div class="py-5">
      <p class="text-[#16968c] mb-5">
        المشرف: <span class="text-[#000]">{{ supervisorName }}</span>
      </p>
      <p class="text-[#16968c]">
        المقاول: <span class="text-[#000]">{{ contractorName }}</span>
      </p>
    </div>
  </div>

  <!-- Asset Information -->
  <div class="bg-white px-5 pt-3 pb-5 rounded mt-5">
    <h1 class="font-bold mb-3">بيانات الأصل</h1>
    <hr />
    <div class="py-5">
      <p class="text-[#16968c] mb-5">
        رقم الأصل: <span class="text-[#000]">{{ assetNumber }}</span>
      </p>
      <p class="text-[#16968c]">
        النظام: <span class="text-[#000]">{{ assetType }}</span>
      </p>
    </div>
  </div>

  <!-- Description and Attachments -->
  <div class="bg-white px-5 pt-3 pb-5 rounded mt-5">
    <h1 class="font-bold mb-3">الوصف و المرفقات</h1>
    <hr />
    <div class="py-5">
      <!-- Notes Section -->
      <p class="text-[#16968c] mb-2">الملاحظات</p>
      <div class="notes bg-gray-50 p-4 rounded mb-5 min-h-[60px]">
        <p class="text-gray-700">{{ notes }}</p>
      </div>

      <!-- Images Section -->
      <p class="text-[#16968c] mb-3">الصور</p>

      <!-- Show message if no images -->
      <div *ngIf="images.length === 0" class="text-gray-500 text-center py-8 bg-gray-50 rounded">
        <i class="fas fa-image text-3xl mb-2"></i>
        <p>لا توجد صور مرفقة</p>
      </div>

      <!-- Display images if available -->
      <div *ngIf="images.length > 0" class="grid grid-cols-12 gap-4">
        <div *ngFor="let image of images; let i = index"
          class="col-span-12 sm:col-span-6 md:col-span-4 lg:col-span-3 xl:col-span-2">
          <div class="relative group cursor-pointer" (click)="onImageClick(image)">
            <img [src]="image.url" [alt]="image.name"
              class="w-full h-24 object-cover rounded border hover:shadow-lg transition-shadow duration-200"
              loading="lazy">

            <!-- Overlay on hover -->
            <div
              class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded flex items-center justify-center">
              <i class="fas fa-expand text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200"></i>
            </div>

            <!-- Image info -->
            <div class="mt-1">
              <p class="text-xs text-gray-600 truncate" [title]="image.name">{{ image.name }}</p>
              <p class="text-xs text-gray-400">{{ image.size }} MB</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Back Button -->
    <div class="mt-6 pt-4 border-t">
      <button class="bg-[#16968c] text-white px-6 py-2 rounded hover:bg-[#14857B] transition-colors duration-200"
        (click)="goBack()">
        <i class="fas fa-arrow-right ml-2"></i>
        العودة للقائمة
      </button>
    </div>
  </div>
</div>

<!-- Error State (optional) -->
<div *ngIf="!isLoading && !logData" class="bg-white px-5 pt-3 pb-5 rounded mt-5">
  <div class="text-center py-8">
    <i class="fas fa-exclamation-triangle text-red-500 text-3xl mb-4"></i>
    <h3 class="text-lg font-semibold text-gray-700 mb-2">لا يمكن تحميل البيانات</h3>
    <p class="text-gray-500 mb-4">حدث خطأ أثناء تحميل بيانات سجل الصيانة</p>
    <button class="bg-[#16968c] text-white px-6 py-2 rounded hover:bg-[#14857B] transition-colors duration-200"
      (click)="goBack()">
      العودة للقائمة
    </button>
  </div>
</div>